perl -ne ' BEGIN{$maf_cutoff=0.03; $miss_maximum = 0.5} $n++; if($n==1){print $_; next} chomp; @t=split /\s+/,$_;   %h=(); map{$h{$_}++}@t[11..$#t];  @ks = (); map{push @ks, $_ unless /N/}keys %h; next unless @ks > 1;  @ks=sort{$h{$a} <=> $h{$b}}@ks;  $typed = $h{$ks[0]} + $h{$ks[1]}; $missing = $#t -10 - $typed;  $maf= $h{$ks[0]} / $typed; $miss_rate = $missing / ($missing + $typed); print $_, "\n" if $maf > $maf_cutoff and $miss_rate < $miss_maximum; print STDERR join("\t", $t[0], $typed, $missing, $maf, $miss_rate), "\n"'   $1  >${1}_filtered_MAF3_MISS.tsv   2>${1}_maf_missing.summary.txt
